\begin{homeworkProblem}[3]
    One view of the cause of the Great Depression is that it is primarily a 
    massive negative money supply shock associated with France (and the U.S.)
    hoarding gold and exchanging sterling for gold. This question asks you to
    analyze the implications of such a shock for output, price, and interest 
    rates through the lens of our business cycle model in its IS-LM-PS 
    incarnation.
    \\ \\
    Consider the following version of our business cycle model:

    \begin{flalign*}
        & \quad \quad \text{LM curve:} \quad \quad \Delta \log M_t - \pi_t = - \phi i_{t} + \phi i_{t-1} + \widetilde{Y}_t - \widetilde{Y}_{t-1} + \Delta \log v_t &\\
        & \quad \quad \text{IS curve:} \quad \quad \widetilde{Y}_t = \overline{a} - \overline{b} (R_t - \overline{r}) &\\
        & \quad \quad \text{Fisher equation:} \quad \quad R_t = i_t - \pi_t &\\
        & \quad \quad \text{Price setting equation:} \quad \quad \pi_t = \theta \widetilde{Y}_{t-1} &\\
    \end{flalign*}
    
    The Fisher equation is written assuming adaptive expectations (i.e.,
    $E_t [\pi_{t+1}] = \pi_t$. Also, the version of the LM curve written above
    comes from taking a first-difference of the LM curve in class and changing 
    variables as before. Throughout this question, you may assume that $\overline{r} = 
    0.02$, $\phi = 0.5$, $\overline{a} = 0$, $\overline{b} = 1$, and $\theta = 0.2$.
    \\ \\
    A) Suppose that the economy starts off in a steady state with $\Delta \log M_t
    = 0$, $\Delta \log v_t = 0$. Calculate the steady state value of the output 
    gap, inflation, the real interest rate, and the nominal interest rate.
    \\ \\
    B) Suppose that at time 0, the money supply in this economy falls by 0.2 log 
    points (i.e., $\Delta \log M_0 = -0.2$) and remains at that new lower level 
    going forward (i.e., $\Delta \log M_t = 0$ for $t > 0$). Plot the evolution
    of output, inflation, the nominal interest rate and the real interest rate 
    over time from period 0 to period 20. (You may want to start your figures at 
    period -5 just to have pre-period in the figures to be able to see the response 
    of the economy better. Also, you may ignore the zero lower bound on nominal 
    interest rates. If you don’t know what that is, this is OK. We will cover it
    in a few weeks.)
    \\ \\
    C) Describe the evolution of the economy in response to the shock in part B)
    graphically using the IS-LM diagram.
    
    \pagebreak

    \part

    Suppose that the economy starts off in a steady state with $\Delta \log M_t
    = 0$, $\Delta \log v_t = 0$. Calculate the steady state value of the output 
    gap, inflation, the real interest rate, and the nominal interest rate.
    \\ \\
    \solution

    To find the steady state value of the output gap, I will first need to find
    the steady state interest rate. To find the steady state real interest rate, 
    I will first need to find the steady state inflation and nominal interest rate
    using the LM curve when there is no change in the money supply or velocity
    in steady state.
    \[
        \begin{split}
            \Delta \log M_t - \pi_t &= - \phi i_t + \phi i_{t-1} + \widetilde{Y}_t - \widetilde{Y}_{t-1} + \Delta \log v_t
            \\
            0 - \pi_t &= - \phi i_t + \phi i_{t-1} + \widetilde{Y}_t - \widetilde{Y}_{t-1} + 0
            \\
            - \pi & = 0 + 0
            \\
            \pi &= 0
        \end{split}
    \]

    So steady state inflation is equal to zero, \fbox{$\pi = 0$}. This makes sense 
    considering thequantity theory of money in a context where there is no steady 
    state change in the money supply. Using the price setting equation, we can find 
    the steady state output gap. 
    \[
        \begin{split}
            \pi_t &= \theta \widetilde{Y}_{t-1}
            \\
            \pi &= \theta \widetilde{Y}
            \\
            0 &= \theta \widetilde{Y}
            \\
            \widetilde{Y} &= 0
        \end{split}
    \]

    Therefore, the output gap is closed at steady state, \fbox{$\widetilde{Y} = 0$}.
    Substituting this value for the steady state output gap alongstide the given
    values for $\overline{r}$, $\overline{a}$, and $\overline{b}$ into the IS curve 
    produces the steady state interest rate.
    \[
        \begin{split}
            \widetilde{Y}_t &= \overline{a} - \overline{b} (R_t - \overline{r})
            \\
            \widetilde{Y} &= 0 - (R - 0.02)
            \\
            0 &= R - 0.02
            \\
            R &= 0.02
            \\
            R &= \overline{r}
        \end{split}
    \]

    The steady state interest rate takes on the exact same value as the natural real 
    interest rate, \fbox{$R=0.02$}. From the Fisher equation, we know then that the 
    steady state nominal interest rate equals the steady state real interest rate 
    since inflation is zero, \fbox{$i=0.02$}. 

    \pagebreak

    \part

    Suppose that at time 0, the money supply in this economy falls by 0.2 log 
    points (i.e., $\Delta \log M_0 = -0.2$) and remains at that new lower level 
    going forward (i.e., $\Delta \log M_t = 0$ for $t > 0$). Plot the evolution
    of output, inflation, the nominal interest rate and the real interest rate 
    over time from period 0 to period 20. (You may want to start your figures at 
    period -5 just to have pre-period in the figures to be able to see the response 
    of the economy better. Also, you may ignore the zero lower bound on nominal 
    interest rates. If you don’t know what that is, this is OK. We will cover it
    in a few weeks.)
    \\ \\
    \solution

    \begin{center}
    \begin{tikzpicture}
        \begin{axis}[
            width=0.9\textwidth, % Make the plot wider
            height=0.5\textwidth,
            xmin=-5,
            xmax=20,
            axis line style={line width=1pt},
            xlabel={Time $t$},
            ylabel={},
            title style={font=\large, align=center},
            xlabel style={font=\large},
            legend style={
                at={(0.5,1.15)}, % Place legend below the plot
                anchor=north,
                legend columns=-1, % Arrange legend in a single row
                font=\small,
                draw=black % Add a border to the legend
            },
            grid=both, % Add gridlines
            minor grid style={dashed, gray!30}, % Style for minor gridlines
            major grid style={solid, gray!60}, % Style for major gridlines
            ]
            \draw[thick, black] (axis cs: 0, \pgfkeysvalueof{/pgfplots/ymin}) -- 
                                (axis cs: 0, \pgfkeysvalueof{/pgfplots/ymax});
            \draw[thick, black] (axis cs: \pgfkeysvalueof{/pgfplots/xmin}, 0) -- 
                                (axis cs: \pgfkeysvalueof{/pgfplots/xmax}, 0);
                                
            \addplot[blue, thick, mark=*] 
            table[x=time, y=output, col sep=comma] {depression.csv};
            \addlegendentry{$\widetilde{Y}_t$}
    
            \addplot[red, thick, mark=square*] 
            table[x=time, y=inflation, col sep=comma] {depression.csv};
            \addlegendentry{$\pi_t$}
            
            \addplot[brown, thick, mark=o] 
            table[x=time, y=nominal, col sep=comma] {depression.csv};
            \addlegendentry{$i_t$}
    
            \addplot[black, thick, mark=x] 
            table[x=time, y=real, col sep=comma] {depression.csv};
            \addlegendentry{$R_t$}
        \end{axis}
    \end{tikzpicture}
    \end{center}

    \pagebreak

    \part

    Describe the evolution of the economy in response to the shock in part B)
    graphically using the IS-LM diagram.
    \\ \\
    \solution

    \begin{center}
    \begin{tikzpicture}
        \begin{axis}[
            axis lines=middle,
            xlabel={$Y$},
            ylabel={$R$},
            xtick=\empty,
            ytick=\empty,
            xmin=0, xmax=10,
            ymin=0, ymax=10,
            xlabel style={at={(axis description cs:1,0)},anchor=west},
            ylabel style={at={(axis description cs:0,1)},anchor=south},
            domain=1:9,
            samples=100,
            enlargelimits=true,
            clip=false
        ]
            % IS Curve
            \addplot[smooth, thick, blue] {7 - 0.5*x} node[pos=0.99, below] {\small IS};
            
            % Original LM Curve
            \addplot[smooth, thick, red] {0.5*x + 2} node[pos=0.9, above left] {\small $LM_1$};
            
            % Shifted LM Curve
            \addplot[smooth, thick, red] {0.5*x + 4} node[pos=0.9, above left] {\small $LM_2$};
            
            % Equilibrium points
            \node[circle,fill,inner sep=1.5pt] at (50,45) {};
            \node[circle,fill,inner sep=1.5pt] at (30,55) {};
            
            % Labels for equilibrium
            % \node[below right] at (50,43) {\small $E_1$};
            % \node[below right] at (29,54) {\small $E_2$};
            
            % Dotted lines for shifts
            \draw[dashed] (axis cs:5,0) -- (axis cs:5,4.5) -- (axis cs:0,4.5);
            \draw[dashed] (axis cs:3,0) -- (axis cs:3,5.5) -- (axis cs:0,5.5);

            \node[below] at (50,-1.95) {\small $Y$};
            \node[below] at (30,0) {\small $\widetilde{Y}$};
            \node[left] at (-2,45) {\small $\overline{r}$};
            \node[left] at (-1,55) {\small $R$};
        \end{axis}
    \end{tikzpicture}
    \end{center}
    
    In the short run, a sudden drop in the money supply will shift the LM curve
    to the left, as interest rates will need to adjust to restore equilibrium
    conditions at all levels of output/income. As this is a short run model,
    over time the interest rate will return to the natural real interest rate
    $\overline{r}$ and the output gap will close. This was seen in the previous
    time series plot as well. 
    
\end{homeworkProblem}